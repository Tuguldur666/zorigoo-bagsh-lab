{% extends "base.html" %}
{% load static %}

{% block title %}Shopping Cart - GreatKart{% endblock %}

{% block content %}
<div class="row">
  <aside class="col-lg-9">
    <div class="card">
      <table class="table table-borderless table-shopping-cart">
        <thead class="text-muted">
          <tr class="small text-uppercase">
            <th scope="col">Product</th>
            <th scope="col" width="120">Quantity</th>
            <th scope="col" width="120">Price</th>
            <th scope="col" class="text-right" width="200"> </th>
          </tr>
        </thead>
        <tbody>
          {% if cart_items %}
            {% for item in cart_items %}
            <tr>
              <td>
                <figure class="itemside align-items-center">
                  <div class="aside">
                    {% if item.product.image %}
                      <img src="{{ item.product.image.url }}" class="img-sm" alt="{{ item.product.product_name }}">
                    {% else %}
                      <img src="{% static 'images/no-image.png' %}" class="img-sm" alt="No image">
                    {% endif %}
                  </div>
                  <figcaption class="info">
                    <a href="{% url 'product_detail' item.product.id %}" class="title text-dark">{{ item.product.product_name }}</a>
                    <p class="text-muted small">Price: ${{ item.product.price|floatformat:2 }}</p>
                  </figcaption>
                </figure>
              </td>
              <td>
                <div class="col">
                  <div class="input-group input-spinner">
                    <div class="input-group-prepend">
                      <a class="btn btn-light" href="{% url 'remove_cart' item.product.id %}"><i class="fa fa-minus"></i></a>
                    </div>
                    <input type="text" class="form-control text-center" value="{{ item.quantity }}" readonly>
                    <div class="input-group-append">
                      <a class="btn btn-light" href="{% url 'add_cart' item.product.id %}"><i class="fa fa-plus"></i></a>
                    </div>
                  </div>
                </div>
              </td>
              <td>
                <div class="price-wrap">
                  <var class="price">${{ item.sub_total|floatformat:2 }}</var>
                  <small class="text-muted">${{ item.product.price|floatformat:2 }} each</small>
                </div>
              </td>
              <td class="text-right">
                <a href="{% url 'remove_cart_item' item.product.id %}" class="btn btn-danger">Remove</a>
              </td>
            </tr>
            {% endfor %}
          {% else %}
            <tr>
              <td colspan="4" class="text-center text-muted">Your cart is empty.</td>
            </tr>
          {% endif %}
        </tbody>
      </table>
    </div>
  </aside>

  <aside class="col-lg-3">
    <div class="card">
      <div class="card-body">
        <dl class="dlist-align">
          <dt>Total items:</dt>
          <dd class="text-right">{{ quantity }}</dd>
        </dl>
        <dl class="dlist-align">
          <dt>Total price:</dt>
          <dd class="text-right">${{ total|floatformat:2 }}</dd>
        </dl>
        <hr>
        <p class="text-center mb-3">
          <img src="{% static 'images/misc/payments.png' %}" height="26" alt="Payment Methods">
        </p>
        <a href="{% url 'checkout' %}" class="btn btn-primary btn-block"> Checkout </a>
        <a href="{% url 'store' %}" class="btn btn-light btn-block">Continue Shopping</a>
      </div>
    </div>
  </aside>
</div>
{% endblock %}
