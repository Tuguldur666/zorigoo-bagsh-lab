{% extends "base.html" %}
{% load static %}

{% block title %}Store | GreatKart{% endblock %}

{% block content %}
<section class="section-pagetop bg">
  <div class="container">
    <h2 class="title-page">Our Store</h2>
  </div>
</section>

<section class="section-content padding-y">
  <div class="container">
    <div class="row">

      <!-- âœ… Sidebar with category filter -->
      <aside class="col-md-3">
        <div class="card">
          <div class="card-header">
            <h6 class="mb-0">Categories</h6>
          </div>
          <ul class="list-group list-group-flush">
            {% for category in links %}
              <li class="list-group-item">
                <a href="{% url 'products_by_category' category.slug %}">
                  {{ category.category_name|upper }}
                </a>
              </li>
            {% endfor %}
          </ul>
        </div>
      </aside>

      <main class="col-md-9">
        <header class="border-bottom mb-4 pb-3">
          <div class="form-inline">
            <span class="mr-md-auto">{{ products|length }} Items found</span>
          </div>
        </header>

        <div class="row">
          {% for product in products %}
          <div class="col-md-4 mb-4">
            <figure class="card card-product-grid h-100">
              <div class="img-wrap">
                <img src="{{ product.images.url }}" alt="{{ product.product_name }}" class="img-fluid">
              </div>
              <figcaption class="info-wrap p-2 text-center">
                <h6 class="title mb-1">{{ product.product_name }}</h6>
                <div class="price-wrap mt-1">
                  <span class="price text-primary">${{ product.price }}</span>
                </div>
                <a href="#" class="btn btn-block btn-success mt-2">Add to cart</a>
              </figcaption>
            </figure>
          </div>
          {% empty %}
          <p class="text-muted">No products available.</p>
          {% endfor %}
        </div>

        <!-- Pagination -->
<!-- Pagination -->
{% if products.has_other_pages %}
<nav class="mt-4" aria-label="Page navigation">
  <ul class="pagination">
    <!-- Previous button -->
    {% if products.has_previous %}
      <li class="page-item">
        <a class="page-link" href="?page={{ products.previous_page_number }}">Previous</a>
      </li>
    {% else %}
      <li class="page-item disabled">
        <span class="page-link">Previous</span>
      </li>
    {% endif %}

    <!-- Page numbers -->
    {% for num in products.paginator.page_range %}
      {% if products.number == num %}
        <li class="page-item active">
          <span class="page-link">{{ num }}</span>
        </li>
      {% else %}
        <li class="page-item">
          <a class="page-link" href="?page={{ num }}">{{ num }}</a>
        </li>
      {% endif %}
    {% endfor %}

    <!-- Next button -->
    {% if products.has_next %}
      <li class="page-item">
        <a class="page-link" href="?page={{ products.next_page_number }}">Next</a>
      </li>
    {% else %}
      <li class="page-item disabled">
        <span class="page-link">Next</span>
      </li>
    {% endif %}
  </ul>
</nav>
{% endif %}

      </main>

    </div>
  </div>
</section>
{% endblock %}
